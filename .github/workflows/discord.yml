name: Notificar no Discord - Front-End

on:
  push:
    branches: [ main ]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Enviar notificaÃ§Ã£o para o Discord (Front-End)
        run: |
          COMMIT_URL="${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }}"
          COMMIT_MSG="${{ github.event.head_commit.message }}"
          DATA_HORA=$(TZ=America/Sao_Paulo date "+%a %d %b %Y %T %Z")

          curl -H "Content-Type: application/json" \
          -X POST \
          -d "{
            \"embeds\": [{
              \"title\": \"ðŸŽ¨ AtualizaÃ§Ã£o no Front-End\",
              \"description\": \"**${{ github.actor }}** enviou um novo commit para o repositÃ³rio **${{ github.repository }}**.\n\nðŸ’¬ **Mensagem do commit:**\n\`\`\`${COMMIT_MSG}\`\`\`\",
              \"color\": 3447003,
              \"fields\": [
                {
                  \"name\": \"ðŸ”— Commit\",
                  \"value\": \"[Ver commit](${COMMIT_URL})\"
                },
                {
                  \"name\": \"ðŸ“¦ Branch\",
                  \"value\": \"${{ github.ref_name }}\",
                  \"inline\": true
                },
                {
                  \"name\": \"ðŸ•’ Hora\",
                  \"value\": \"${DATA_HORA}\",
                  \"inline\": true
                }
              ],
              \"footer\": {
                \"text\": \"Front-end com novidades fresquinhas ðŸ’…âœ¨\"
              }
            }]
          }" \
          ${{ secrets.DISCORD_WEBHOOK }}
