name: Notificar no Discord

on:
  push:
    branches: [ main ]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Enviar notificaÃ§Ã£o para o Discord
        run: |
          COMMIT_URL="${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }}"
          DATA_HORA=$(TZ=America/Sao_Paulo date "+%a %d %b %Y %T %Z")

          curl -H "Content-Type: application/json" \
          -X POST \
          -d "{
            \"embeds\": [{
              \"title\": \"ðŸš€ Novo Push Realizado!\",
              \"description\": \"Um novo commit foi enviado por **${{ github.actor }}** no repositÃ³rio **${{ github.repository }}**.\",
              \"color\": 5814783,
              \"fields\": [
                {
                  \"name\": \"ðŸ”— Commit\",
                  \"value\": \"[Ver commit](${COMMIT_URL})\"
                },
                {
                  \"name\": \"ðŸ“¦ Branch\",
                  \"value\": \"${{ github.ref_name }}\",
                  \"inline\": true
                },
                {
                  \"name\": \"ðŸ•’ Hora\",
                  \"value\": \"${DATA_HORA}\",
                  \"inline\": true
                }
              ],
              \"footer\": {
                \"text\": \"Um salto no seu conhecimento!\"
              }
            }]
          }" \
          ${{ secrets.DISCORD_WEBHOOK }}
